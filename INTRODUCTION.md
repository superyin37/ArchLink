# 建筑规范智能识别与检索系统 - 面试介绍文档

## 📋 项目概述

这是一个基于AI技术的建筑规范智能识别与检索系统，主要解决建筑设计和施工领域中**快速定位CAD图纸中引用的规范详图**的痛点问题。系统包含**规范定位服务**和**RAG智能问答**两大核心功能模块。

**核心价值**：将原本需要5-10分钟的人工查找规范过程，缩短到1秒内自动完成，大幅提升建筑设计人员的工作效率。

---

## 🎯 业务背景

### 行业痛点
在建筑设计过程中，CAD图纸会大量引用标准图集（如"23J909 1-11"），设计师需要：
1. 识别截图中的规范编号和页码
2. 在海量PDF文件中查找对应文档
3. 定位具体页码并查看详图

这个过程繁琐且容易出错，影响工作效率。

### 解决方案
- **自动识别**：上传CAD截图，自动识别规范编号和页码
- **快速定位**：在2680+份规范文件中精准匹配
- **即时获取**：直接下载对应的PDF文件

---

## 🏗️ 系统架构

### 整体架构
```
┌─────────────────────────────────────────────────────────┐
│                      前端界面                            │
│                  (Web UI + API Docs)                    │
└────────────────────┬────────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────────┐
│                  FastAPI 后端服务                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  图像上传    │  │  识别引擎    │  │  文件定位    │  │
│  │  预处理      │  │  OCR/LLM     │  │  下载服务    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────────┐
│              数据层 (2680+ PDF文件)                      │
│        + ChromaDB向量库 (RAG扩展功能)                    │
└─────────────────────────────────────────────────────────┘
```

### 核心模块
```
spec_locator/
├── api/              # FastAPI服务层
│   ├── server.py     # HTTP接口
│   └── demo.html     # Web界面
├── core/             # 核心识别流程
│   └── pipeline.py   # 识别主流程
├── ocr/              # OCR识别引擎
│   └── ocr_engine.py # PaddleOCR封装
├── llm/              # LLM识别引擎
│   ├── doubao_engine.py   # 豆包
│   ├── chatgpt_engine.py  # GPT
│   └── gemini_engine.py   # Gemini
├── preprocess/       # 图像预处理
├── parser/           # 解析与匹配
├── postprocess/      # 置信度评估
└── database/         # 文件索引
```

---

## 💡 核心技术亮点

### 1. 双引擎识别系统

#### **OCR识别引擎** (主要方式)
- **技术选型**：PaddleOCR - 国产开源OCR引擎
- **性能优势**：识别速度<1秒，启动快速，完全免费
- **核心流程**：
  ```python
  图像 → 预处理(去线/增强/二值化) → OCR识别 
       → 规范编号解析 → 页码识别 → 几何关系分析 
       → 置信度评估 → 排序输出
  ```
- **技术难点**：
  - **规范编号识别**：支持多种格式（12J2、L13J5-1、津07SJ110等）
  - **页码识别**：处理C11、1-11、123等复杂格式
  - **几何关系分析**：通过空间位置匹配规范编号与页码

#### **LLM识别引擎** (补充方式)
- **技术选型**：支持多种大模型（豆包Vision/GPT-4o/Gemini）
- **优势**：直接理解图像语义，无需复杂规则，容错性强
- **适用场景**：模糊、倾斜、手写或OCR失败的情况

### 2. 智能切换机制 (Auto模式)

这是我设计的核心创新点，实现**成本与效果的最优平衡**：

| 模式 | 说明 | 速度 | 准确率 | 成本 |
|------|------|------|--------|------|
| **ocr** | 纯OCR识别 | ⚡ 快 (<1秒) | 中等 | 免费 |
| **llm** | 纯LLM识别 | 🐢 慢 (3-5秒) | 高 | 付费 |
| **auto** | 智能切换 | ⚖️ 适中 | 高 | 按需 |

**Auto模式策略**：
```python
1. 优先使用OCR识别 (快速+免费)
2. 实时评估置信度 (0-1分值)
3. 低于阈值时自动切换LLM (准确+容错)
4. 返回最优结果
```

**实际效果**：
- 80%的请求由OCR处理（免费+快速）
- 20%困难场景由LLM处理（精准）
- 整体准确率提升至90%+

### 3. 文件索引与匹配

- **索引规模**：2680+ PDF文件，30GB+ 数据
- **智能匹配**：
  - 模糊匹配：12J2 ↔ 12J2-1 自动关联
  - 多页码格式：C11、1-11、123统一识别
  - 候选排序：多结果按置信度排序
- **性能优化**：
  - 预加载文件索引（避免运行时扫描）
  - 内存缓存热点数据
  - 并发访问支持

### 4. 懒加载与性能优化

**问题**：PaddleOCR模型加载需要3-5秒，影响首次请求体验

**解决方案**：
```python
class OCREngine:
    def __init__(self, lazy_load=True):
        self.model = None  # 延迟初始化
    
    def recognize(self, image):
        if self.model is None:
            self._load_model()  # 首次调用时加载
        return self._process(image)
```

**优化效果**：
- 服务启动时间：8秒 → <1秒
- 首次请求：4秒（含模型加载）
- 后续请求：<1秒

---

## 🚀 扩展功能：RAG智能问答系统

### 技术架构
基于**检索增强生成(RAG)**技术，构建建筑知识问答系统：

```
用户问题 → 向量检索 → Rerank重排 → LLM生成答案
              ↓
        ChromaDB向量库
     (规范库 + 案例库)
```

### 核心模块

#### 1. 多执行器架构
- **anliku_executor.py**：建筑案例库查询
- **guifan_executor.py**：建筑规范库查询  
- **main_executor.py**：统一调度与路由

#### 2. Reranker模块
实现了三种Reranker策略：
- **SimilarityReranker**：基于余弦相似度（快速）
- **LLMReranker**：基于大模型评估（精准）
- **HybridReranker**：混合策略（平衡）

#### 3. 增量索引
```python
# 基于哈希的增量更新机制
processed_hashes = load_processed_hashes()
for doc in new_docs:
    doc_hash = hash(doc.content)
    if doc_hash not in processed_hashes:
        index.add(doc)
        processed_hashes.add(doc_hash)
```

### 关键技术
- **向量数据库**：ChromaDB（轻量级、易部署）
- **文档处理**：智能分块、去重、元数据提取
- **多轮对话**：上下文管理、对话历史
- **来源追溯**：答案关联原始文档

---

## 🛠️ 技术栈

### 后端技术
- **Web框架**：FastAPI（异步高性能）
- **OCR引擎**：PaddleOCR（国产开源）
- **图像处理**：OpenCV、NumPy、PIL
- **LLM集成**：豆包/ChatGPT/Gemini API
- **向量数据库**：ChromaDB
- **文档处理**：PyPDF、LangChain

### 部署技术
- **容器化**：Docker + Docker Compose
- **云平台**：AWS EC2（已部署生产环境）
- **Web服务器**：Uvicorn（ASGI服务器）

---

## 📊 项目数据

| 指标 | 数据 |
|------|------|
| **代码规模** | 2500+ 行核心代码 |
| **模块数量** | 8个核心模块 |
| **测试覆盖** | 单元测试 + 集成测试 |
| **文档数量** | 15+ 份技术文档 |
| **PDF索引** | 2680+ 份规范文件 |
| **数据规模** | 30GB+ PDF数据 |
| **识别速度** | OCR: <1秒, LLM: 3-5秒 |
| **识别准确率** | 90%+ (Auto模式) |
| **API端点** | 5个核心接口 |
| **并发支持** | 10+ 并发用户 |

---

## 🎓 个人贡献与收获

### 核心贡献
1. **系统设计**：从0到1设计整个系统架构
2. **双引擎实现**：独立实现OCR和LLM识别引擎
3. **智能切换**：设计并实现Auto模式的智能切换策略
4. **性能优化**：通过懒加载、并发等手段优化性能
5. **云端部署**：完成AWS EC2生产环境部署

### 技术成长
- **OCR技术**：深入理解OCR原理、预处理、后处理
- **LLM应用**：掌握多种大模型API集成与优化
- **RAG架构**：实践向量检索、Rerank、提示工程
- **FastAPI**：熟练使用异步框架构建高性能API
- **Docker部署**：掌握容器化部署与云端运维

### 问题解决能力
- **识别准确率**：从60%优化到90%+
- **启动速度**：从8秒优化到<1秒
- **成本控制**：通过智能切换降低80%的API成本

---

## 🔮 项目亮点总结

### 技术亮点
1. ✅ **双引擎架构**：OCR+LLM互补，兼顾速度与准确率
2. ✅ **智能切换**：Auto模式自动选择最优策略
3. ✅ **懒加载优化**：解决模型加载延迟问题
4. ✅ **规范化解析**：处理多种复杂格式的规范编号和页码
5. ✅ **RAG扩展**：构建领域知识问答系统
6. ✅ **生产部署**：完整的Docker容器化与云端部署

### 业务价值
1. 🎯 **效率提升**：查找规范时间从5-10分钟降至1秒
2. 💰 **成本优化**：智能切换降低80%的API成本
3. 📈 **准确率高**：识别准确率达90%+
4. 🚀 **易扩展**：模块化设计，易于添加新功能

---

## 💼 项目展示建议

### 演示要点
1. **业务场景**：展示实际CAD截图识别过程
2. **技术对比**：演示OCR vs LLM vs Auto的差异
3. **API文档**：展示FastAPI自动生成的Swagger文档
4. **性能指标**：展示识别速度和准确率

### 可能的问题准备
1. **Q: 为什么选择PaddleOCR？**
   - A: 国产开源、轻量级、支持中英文、无需GPU即可高性能运行
   
2. **Q: Auto模式的切换阈值如何确定？**
   - A: 通过100+样本测试，发现置信度0.7是最优阈值点
   
3. **Q: 如何处理OCR识别错误？**
   - A: 三层处理：1)图像预处理增强 2)置信度评估 3)LLM兜底
   
4. **Q: 系统如何扩展支持更多规范？**
   - A: 只需添加PDF文件到指定目录，系统自动扫描并索引
   
5. **Q: 为什么不直接使用LLM？**
   - A: 成本考虑，OCR免费且快速，LLM作为精准补充

---

## 📞 项目链接

- **项目地址**：本地开发环境
- **在线演示**：AWS EC2部署 `http://<EC2-IP>:8002/`
- **API文档**：`http://<EC2-IP>:8002/docs`
- **技术文档**：项目根目录下的markdown文档

---

## 🎤 一分钟电梯演讲

> 我开发了一个**建筑规范智能识别系统**，解决建筑设计师在CAD图纸中查找规范详图的痛点。
> 
> 系统采用**OCR+LLM双引擎架构**，通过智能切换策略实现**90%+的识别准确率**，同时将查找时间从**5-10分钟缩短到1秒**。我还设计了**Auto模式**，在保证准确率的同时降低了**80%的API成本**。
> 
> 技术栈包括FastAPI、PaddleOCR、多种大模型API，以及基于ChromaDB的RAG问答系统。项目已通过Docker部署到AWS生产环境，支持**2680+份规范文件**的实时检索。
> 
> 这个项目让我深入理解了**OCR、LLM和RAG技术的实际应用**，以及如何在**性能、成本和准确率之间做权衡优化**。

---

*最后更新：2026年2月*
